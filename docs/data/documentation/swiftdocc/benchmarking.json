{
  "abstract" : [
    {
      "text" : "Produce performance metrics to improve the compilation pipeline and track regressions.",
      "type" : "text"
    }
  ],
  "hierarchy" : {
    "paths" : [
      [
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC"
      ]
    ]
  },
  "identifier" : {
    "interfaceLanguage" : "swift",
    "url" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmarking"
  },
  "kind" : "article",
  "metadata" : {
    "modules" : [
      {
        "name" : "SwiftDocC"
      }
    ],
    "role" : "collectionGroup",
    "title" : "Benchmarking"
  },
  "primaryContentSections" : [
    {
      "content" : [
        {
          "anchor" : "overview",
          "level" : 2,
          "text" : "Overview",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "DocC has metric logging built right in; it is disabled by default but it can be enabled easily via an environment variable or when running the included ",
              "type" : "text"
            },
            {
              "code" : "bin\/benchmark.swift",
              "type" : "codeVoice"
            },
            {
              "text" : " script.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "When you are working on a PR to add a feature or fix a bug you should evaluate the performance cost of your code changes.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "anchor" : "Running-a-benchmark",
          "level" : 2,
          "text" : "Running a benchmark",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "To benchmark the ",
              "type" : "text"
            },
            {
              "code" : "convert",
              "type" : "codeVoice"
            },
            {
              "text" : " command with a given documentation bundle ",
              "type" : "text"
            },
            {
              "code" : "MyFramework.docc",
              "type" : "codeVoice"
            },
            {
              "text" : " run:",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "code" : [
            "swift bin\/benchmark.swift convert MyFramework.docc"
          ],
          "syntax" : null,
          "type" : "codeListing"
        },
        {
          "inlineContent" : [
            {
              "text" : "The automation script will enable metrics logging, do five sequential runs of the ",
              "type" : "text"
            },
            {
              "code" : "convert",
              "type" : "codeVoice"
            },
            {
              "text" : " command, and finally save a JSON file with the results on disk.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "Provide the ",
              "type" : "text"
            },
            {
              "code" : "--base-benchmark",
              "type" : "codeVoice"
            },
            {
              "text" : " option in order to compare the current benchmark with a previous JSON file you already have on disk to evaluate improvements or track that you are not regressing.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "code" : [
            "swift bin\/benchmark.swift --base-benchmark baseline-benchmark.json convert MyFramework.docc"
          ],
          "syntax" : null,
          "type" : "codeListing"
        },
        {
          "anchor" : "Adding-a-Custom-Metric",
          "level" : 2,
          "text" : "Adding a Custom Metric",
          "type" : "heading"
        },
        {
          "inlineContent" : [
            {
              "text" : "When you work on a particular feature and you want to track a given custom metric you can temporarily add it to the log.",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "inlineContent" : [
            {
              "text" : "For example, to add a metric that counts the registered bundles, create a ",
              "type" : "text"
            },
            {
              "code" : "BundlesCount",
              "type" : "codeVoice"
            },
            {
              "text" : " class that adopts the ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/BenchmarkMetric",
              "isActive" : true,
              "type" : "reference"
            },
            {
              "text" : " protocol:",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "code" : [
            "class BundlesCount: BenchmarkMetric {",
            "  static let identifier = \"bundles-count\"",
            "  static let displayName = \"Bundles Count\"",
            "  ",
            "  var result: MetricValue?",
            "  ",
            "  init(context: DocumentationContext) {",
            "    result = .number(Double(context.registeredBundles.count))",
            "  }",
            "}"
          ],
          "syntax" : "swift",
          "type" : "codeListing"
        },
        {
          "inlineContent" : [
            {
              "text" : "Add your custom metric to the default log by using ",
              "type" : "text"
            },
            {
              "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/benchmark(add:benchmarkLog:)",
              "isActive" : true,
              "type" : "reference"
            },
            {
              "text" : ":",
              "type" : "text"
            }
          ],
          "type" : "paragraph"
        },
        {
          "code" : [
            "benchmark(add: BundlesCount(context: context))"
          ],
          "syntax" : "swift",
          "type" : "codeListing"
        }
      ],
      "kind" : "content"
    }
  ],
  "schemaVersion" : {
    "major" : 0,
    "minor" : 2,
    "patch" : 0
  },
  "sections" : [

  ],
  "seeAlsoSections" : [
    {
      "generated" : true,
      "identifiers" : [
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/EmittingDiagnostics",
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/StaticAnalysis"
      ],
      "title" : "Diagnostics and Analysis"
    }
  ],
  "topicSections" : [
    {
      "identifiers" : [
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark",
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark\/main"
      ],
      "title" : "Benchmark Log"
    },
    {
      "identifiers" : [
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark\/Duration",
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark\/OutputSize",
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark\/PeakMemory",
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark\/TopicGraphHash",
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark\/ExternalTopicsHash"
      ],
      "title" : "Default Metrics"
    },
    {
      "identifiers" : [
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/benchmark(add:benchmarkLog:)",
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/benchmark(begin:benchmarkLog:)",
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/benchmark(end:benchmarkLog:)",
        "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/benchmark(wrap:benchmarkLog:body:)"
      ],
      "title" : "Logging Metrics"
    }
  ],
  "variants" : [
    {
      "paths" : [
        "\/documentation\/swiftdocc\/benchmarking"
      ],
      "traits" : [
        {
          "interfaceLanguage" : "swift"
        }
      ]
    }
  ]
, 
"references": {
"doc://SwiftDocC/documentation/SwiftDocC": {
  "abstract" : [
    {
      "text" : "Combine code comments with markup prose to produce structured, semantic documentation.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC",
  "kind" : "symbol",
  "role" : "collection",
  "title" : "SwiftDocC",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc"
},
"doc://SwiftDocC/documentation/SwiftDocC/Benchmark": {
  "abstract" : [
    {
      "text" : "A logger that runs benchmarks and stores the results.",
      "type" : "text"
    }
  ],
  "fragments" : [
    {
      "kind" : "keyword",
      "text" : "class"
    },
    {
      "kind" : "text",
      "text" : " "
    },
    {
      "kind" : "identifier",
      "text" : "Benchmark"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark",
  "kind" : "symbol",
  "navigatorTitle" : [
    {
      "kind" : "identifier",
      "text" : "Benchmark"
    }
  ],
  "role" : "symbol",
  "title" : "Benchmark",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/benchmark"
},
"doc://SwiftDocC/documentation/SwiftDocC/Benchmark/Duration": {
  "abstract" : [
    {
      "text" : "A duration metric in milliseconds.",
      "type" : "text"
    }
  ],
  "fragments" : [
    {
      "kind" : "keyword",
      "text" : "class"
    },
    {
      "kind" : "text",
      "text" : " "
    },
    {
      "kind" : "identifier",
      "text" : "Duration"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark\/Duration",
  "kind" : "symbol",
  "navigatorTitle" : [
    {
      "kind" : "identifier",
      "text" : "Duration"
    }
  ],
  "role" : "symbol",
  "title" : "Benchmark.Duration",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/benchmark\/duration"
},
"doc://SwiftDocC/documentation/SwiftDocC/Benchmark/ExternalTopicsHash": {
  "abstract" : [
    {
      "text" : "A hash metric produced off the externally resolved links and symbols.",
      "type" : "text"
    }
  ],
  "fragments" : [
    {
      "kind" : "keyword",
      "text" : "class"
    },
    {
      "kind" : "text",
      "text" : " "
    },
    {
      "kind" : "identifier",
      "text" : "ExternalTopicsHash"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark\/ExternalTopicsHash",
  "kind" : "symbol",
  "navigatorTitle" : [
    {
      "kind" : "identifier",
      "text" : "ExternalTopicsHash"
    }
  ],
  "role" : "symbol",
  "title" : "Benchmark.ExternalTopicsHash",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/benchmark\/externaltopicshash"
},
"doc://SwiftDocC/documentation/SwiftDocC/Benchmark/OutputSize": {
  "abstract" : [
    {
      "text" : "A disk size metric for a given directory.",
      "type" : "text"
    }
  ],
  "fragments" : [
    {
      "kind" : "keyword",
      "text" : "class"
    },
    {
      "kind" : "text",
      "text" : " "
    },
    {
      "kind" : "identifier",
      "text" : "OutputSize"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark\/OutputSize",
  "kind" : "symbol",
  "navigatorTitle" : [
    {
      "kind" : "identifier",
      "text" : "OutputSize"
    }
  ],
  "role" : "symbol",
  "title" : "Benchmark.OutputSize",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/benchmark\/outputsize"
},
"doc://SwiftDocC/documentation/SwiftDocC/Benchmark/PeakMemory": {
  "abstract" : [
    {
      "text" : "A peak memory footprint metric for the current process.",
      "type" : "text"
    }
  ],
  "fragments" : [
    {
      "kind" : "keyword",
      "text" : "class"
    },
    {
      "kind" : "text",
      "text" : " "
    },
    {
      "kind" : "identifier",
      "text" : "PeakMemory"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark\/PeakMemory",
  "kind" : "symbol",
  "navigatorTitle" : [
    {
      "kind" : "identifier",
      "text" : "PeakMemory"
    }
  ],
  "role" : "symbol",
  "title" : "Benchmark.PeakMemory",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/benchmark\/peakmemory"
},
"doc://SwiftDocC/documentation/SwiftDocC/Benchmark/TopicGraphHash": {
  "abstract" : [
    {
      "text" : "A hash metric produced off the given documentation context.",
      "type" : "text"
    }
  ],
  "fragments" : [
    {
      "kind" : "keyword",
      "text" : "class"
    },
    {
      "kind" : "text",
      "text" : " "
    },
    {
      "kind" : "identifier",
      "text" : "TopicGraphHash"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark\/TopicGraphHash",
  "kind" : "symbol",
  "navigatorTitle" : [
    {
      "kind" : "identifier",
      "text" : "TopicGraphHash"
    }
  ],
  "role" : "symbol",
  "title" : "Benchmark.TopicGraphHash",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/benchmark\/topicgraphhash"
},
"doc://SwiftDocC/documentation/SwiftDocC/Benchmark/main": {
  "abstract" : [
    {
      "text" : "The shared instance to use for logging.",
      "type" : "text"
    }
  ],
  "fragments" : [
    {
      "kind" : "keyword",
      "text" : "static"
    },
    {
      "kind" : "text",
      "text" : " "
    },
    {
      "kind" : "keyword",
      "text" : "let"
    },
    {
      "kind" : "text",
      "text" : " "
    },
    {
      "kind" : "identifier",
      "text" : "main"
    },
    {
      "kind" : "text",
      "text" : ": "
    },
    {
      "kind" : "typeIdentifier",
      "preciseIdentifier" : "s:9SwiftDocC9BenchmarkC",
      "text" : "Benchmark"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/Benchmark\/main",
  "kind" : "symbol",
  "role" : "symbol",
  "title" : "main",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/benchmark\/main"
},
"doc://SwiftDocC/documentation/SwiftDocC/BenchmarkMetric": {
  "abstract" : [
    {
      "text" : "A generic, named metric.",
      "type" : "text"
    }
  ],
  "fragments" : [
    {
      "kind" : "keyword",
      "text" : "protocol"
    },
    {
      "kind" : "text",
      "text" : " "
    },
    {
      "kind" : "identifier",
      "text" : "BenchmarkMetric"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/BenchmarkMetric",
  "kind" : "symbol",
  "navigatorTitle" : [
    {
      "kind" : "identifier",
      "text" : "BenchmarkMetric"
    }
  ],
  "role" : "symbol",
  "title" : "BenchmarkMetric",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/benchmarkmetric"
},
"doc://SwiftDocC/documentation/SwiftDocC/EmittingDiagnostics": {
  "abstract" : [
    {
      "text" : "Vend warnings and errors as part of an operation’s result.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/EmittingDiagnostics",
  "kind" : "article",
  "role" : "collectionGroup",
  "title" : "Emitting Diagnostics",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/emittingdiagnostics"
},
"doc://SwiftDocC/documentation/SwiftDocC/StaticAnalysis": {
  "abstract" : [
    {
      "text" : "Run static analysis checks on markup files.",
      "type" : "text"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/StaticAnalysis",
  "kind" : "article",
  "role" : "collectionGroup",
  "title" : "Static Analysis",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/staticanalysis"
},
"doc://SwiftDocC/documentation/SwiftDocC/benchmark(add:benchmarkLog:)": {
  "abstract" : [
    {
      "text" : "Logs a one-off metric value.",
      "type" : "text"
    }
  ],
  "fragments" : [
    {
      "kind" : "keyword",
      "text" : "func"
    },
    {
      "kind" : "text",
      "text" : " "
    },
    {
      "kind" : "identifier",
      "text" : "benchmark"
    },
    {
      "kind" : "text",
      "text" : "<"
    },
    {
      "kind" : "genericParameter",
      "text" : "E"
    },
    {
      "kind" : "text",
      "text" : ">("
    },
    {
      "kind" : "externalParam",
      "text" : "add"
    },
    {
      "kind" : "text",
      "text" : ": () -> "
    },
    {
      "kind" : "typeIdentifier",
      "text" : "E"
    },
    {
      "kind" : "text",
      "text" : ", "
    },
    {
      "kind" : "externalParam",
      "text" : "benchmarkLog"
    },
    {
      "kind" : "text",
      "text" : ": "
    },
    {
      "kind" : "typeIdentifier",
      "preciseIdentifier" : "s:9SwiftDocC9BenchmarkC",
      "text" : "Benchmark"
    },
    {
      "kind" : "text",
      "text" : ")"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/benchmark(add:benchmarkLog:)",
  "kind" : "symbol",
  "role" : "symbol",
  "title" : "benchmark(add:benchmarkLog:)",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/benchmark(add:benchmarklog:)"
},
"doc://SwiftDocC/documentation/SwiftDocC/benchmark(begin:benchmarkLog:)": {
  "abstract" : [
    {
      "text" : "Starts the given metric.",
      "type" : "text"
    }
  ],
  "fragments" : [
    {
      "kind" : "keyword",
      "text" : "func"
    },
    {
      "kind" : "text",
      "text" : " "
    },
    {
      "kind" : "identifier",
      "text" : "benchmark"
    },
    {
      "kind" : "text",
      "text" : "<"
    },
    {
      "kind" : "genericParameter",
      "text" : "E"
    },
    {
      "kind" : "text",
      "text" : ">("
    },
    {
      "kind" : "externalParam",
      "text" : "begin"
    },
    {
      "kind" : "text",
      "text" : ": () -> "
    },
    {
      "kind" : "typeIdentifier",
      "text" : "E"
    },
    {
      "kind" : "text",
      "text" : ", "
    },
    {
      "kind" : "externalParam",
      "text" : "benchmarkLog"
    },
    {
      "kind" : "text",
      "text" : ": "
    },
    {
      "kind" : "typeIdentifier",
      "preciseIdentifier" : "s:9SwiftDocC9BenchmarkC",
      "text" : "Benchmark"
    },
    {
      "kind" : "text",
      "text" : ") -> "
    },
    {
      "kind" : "typeIdentifier",
      "text" : "E"
    },
    {
      "kind" : "text",
      "text" : "?"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/benchmark(begin:benchmarkLog:)",
  "kind" : "symbol",
  "role" : "symbol",
  "title" : "benchmark(begin:benchmarkLog:)",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/benchmark(begin:benchmarklog:)"
},
"doc://SwiftDocC/documentation/SwiftDocC/benchmark(end:benchmarkLog:)": {
  "abstract" : [
    {
      "text" : "Ends the given metric and adds it to the log.",
      "type" : "text"
    }
  ],
  "fragments" : [
    {
      "kind" : "keyword",
      "text" : "func"
    },
    {
      "kind" : "text",
      "text" : " "
    },
    {
      "kind" : "identifier",
      "text" : "benchmark"
    },
    {
      "kind" : "text",
      "text" : "<"
    },
    {
      "kind" : "genericParameter",
      "text" : "E"
    },
    {
      "kind" : "text",
      "text" : ">("
    },
    {
      "kind" : "externalParam",
      "text" : "end"
    },
    {
      "kind" : "text",
      "text" : ": () -> "
    },
    {
      "kind" : "typeIdentifier",
      "text" : "E"
    },
    {
      "kind" : "text",
      "text" : "?, "
    },
    {
      "kind" : "externalParam",
      "text" : "benchmarkLog"
    },
    {
      "kind" : "text",
      "text" : ": "
    },
    {
      "kind" : "typeIdentifier",
      "preciseIdentifier" : "s:9SwiftDocC9BenchmarkC",
      "text" : "Benchmark"
    },
    {
      "kind" : "text",
      "text" : ")"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/benchmark(end:benchmarkLog:)",
  "kind" : "symbol",
  "role" : "symbol",
  "title" : "benchmark(end:benchmarkLog:)",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/benchmark(end:benchmarklog:)"
},
"doc://SwiftDocC/documentation/SwiftDocC/benchmark(wrap:benchmarkLog:body:)": {
  "abstract" : [
    {
      "text" : "Ends the given metric and adds it to the log.",
      "type" : "text"
    }
  ],
  "fragments" : [
    {
      "kind" : "keyword",
      "text" : "func"
    },
    {
      "kind" : "text",
      "text" : " "
    },
    {
      "kind" : "identifier",
      "text" : "benchmark"
    },
    {
      "kind" : "text",
      "text" : "<"
    },
    {
      "kind" : "genericParameter",
      "text" : "E"
    },
    {
      "kind" : "text",
      "text" : ", "
    },
    {
      "kind" : "genericParameter",
      "text" : "Result"
    },
    {
      "kind" : "text",
      "text" : ">("
    },
    {
      "kind" : "externalParam",
      "text" : "wrap"
    },
    {
      "kind" : "text",
      "text" : ": () -> "
    },
    {
      "kind" : "typeIdentifier",
      "text" : "E"
    },
    {
      "kind" : "text",
      "text" : ", "
    },
    {
      "kind" : "externalParam",
      "text" : "benchmarkLog"
    },
    {
      "kind" : "text",
      "text" : ": "
    },
    {
      "kind" : "typeIdentifier",
      "preciseIdentifier" : "s:9SwiftDocC9BenchmarkC",
      "text" : "Benchmark"
    },
    {
      "kind" : "text",
      "text" : ", "
    },
    {
      "kind" : "externalParam",
      "text" : "body"
    },
    {
      "kind" : "text",
      "text" : ": () "
    },
    {
      "kind" : "keyword",
      "text" : "throws"
    },
    {
      "kind" : "text",
      "text" : " -> "
    },
    {
      "kind" : "typeIdentifier",
      "text" : "Result"
    },
    {
      "kind" : "text",
      "text" : ") "
    },
    {
      "kind" : "keyword",
      "text" : "rethrows"
    },
    {
      "kind" : "text",
      "text" : " -> "
    },
    {
      "kind" : "typeIdentifier",
      "text" : "Result"
    }
  ],
  "identifier" : "doc:\/\/SwiftDocC\/documentation\/SwiftDocC\/benchmark(wrap:benchmarkLog:body:)",
  "kind" : "symbol",
  "role" : "symbol",
  "title" : "benchmark(wrap:benchmarkLog:body:)",
  "type" : "topic",
  "url" : "\/documentation\/swiftdocc\/benchmark(wrap:benchmarklog:body:)"
}
}
}